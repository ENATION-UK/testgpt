# 分类管理功能使用说明

## 功能概述

分类管理功能为测试用例提供了多级、无限级的分类管理能力，支持：

- 创建多级分类结构
- 分类的增删改查操作
- 测试用例按分类筛选
- 支持选择父分类时显示所有子分类的用例

## 主要特性

### 1. 多级分类结构
- 支持无限级分类嵌套
- 自动计算分类层级
- 防止循环引用
- 支持分类排序

### 2. 分类管理界面
- 树形结构展示分类
- 支持创建、编辑、删除分类
- 显示每个分类下的测试用例数量
- 支持分类状态管理（激活/非激活）

### 3. 测试用例分类筛选
- 级联选择器选择分类
- 支持按分类筛选测试用例
- 选择父分类时自动包含所有子分类的用例
- 支持分类、状态、优先级多条件筛选

## 使用指南

### 访问分类管理

1. 在导航菜单中点击"分类管理"
2. 或者在测试用例管理页面点击"分类管理"按钮

### 创建分类

1. 在分类管理页面点击"创建分类"按钮
2. 填写分类信息：
   - **分类名称**：必填，1-100个字符
   - **分类描述**：可选，最多500个字符
   - **父分类**：可选，选择上级分类
   - **排序**：可选，数字越小排序越靠前
3. 点击"创建"按钮

### 编辑分类

1. 在分类树中点击对应分类的"编辑"按钮
2. 修改分类信息
3. 点击"更新"按钮

### 添加子分类

1. 在分类树中点击对应分类的"添加子分类"按钮
2. 填写子分类信息
3. 点击"创建"按钮

### 删除分类

1. 在分类树中点击对应分类的"删除"按钮
2. 确认删除操作
   - 如果分类下有子分类，会提示是否强制删除
   - 如果分类下有关联的测试用例，会提示是否强制删除

### 筛选测试用例

1. 在测试用例管理页面使用分类筛选器
2. 选择要筛选的分类
3. 系统会自动显示该分类及其所有子分类下的测试用例
4. 可以结合状态、优先级等其他条件进行筛选

## 数据库结构

### 分类表 (category)

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | INTEGER | 主键ID |
| name | VARCHAR(100) | 分类名称 |
| description | TEXT | 分类描述 |
| parent_id | INTEGER | 父分类ID |
| level | INTEGER | 分类层级 |
| sort_order | INTEGER | 排序顺序 |
| is_active | BOOLEAN | 是否激活 |
| created_at | DATETIME | 创建时间 |
| updated_at | DATETIME | 更新时间 |
| is_deleted | BOOLEAN | 是否删除 |

### 测试用例表更新

在原有的 `test_case` 表中添加了 `category_id` 字段，用于关联分类。

## API接口

### 分类管理API

- `GET /api/categories` - 获取分类列表
- `GET /api/categories/tree` - 获取分类树形结构
- `GET /api/categories/{id}` - 获取单个分类
- `POST /api/categories` - 创建分类
- `PUT /api/categories/{id}` - 更新分类
- `DELETE /api/categories/{id}` - 删除分类
- `GET /api/categories/{id}/test-cases` - 获取分类下的测试用例

### 测试用例API更新

- `GET /api/test-cases` - 支持 `category_id` 参数进行筛选

## 示例分类结构

系统预置了以下示例分类结构：

```
功能测试
├── 用户管理
├── 订单管理
└── 商品管理

性能测试
├── 压力测试
└── 负载测试

安全测试

兼容性测试
```

## 注意事项

1. **删除分类**：删除分类时会检查是否有子分类或关联的测试用例，可以选择强制删除
2. **循环引用**：系统会防止创建循环引用的分类结构
3. **分类层级**：系统会自动计算和维护分类层级
4. **数据一致性**：删除分类时，关联的测试用例的分类字段会被清空

## 技术实现

### 后端技术栈
- FastAPI + SQLAlchemy
- 支持MySQL和SQLite数据库
- 递归查询实现树形结构

### 前端技术栈
- Vue 3 + TypeScript
- Element Plus UI组件库
- 级联选择器实现分类选择

## 扩展功能

未来可以考虑添加的功能：

1. 分类导入/导出
2. 分类权限管理
3. 分类统计报表
4. 分类标签功能
5. 分类模板功能 